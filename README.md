## Overview

Uploading a lot of photos through Tumblr's web interface is lousy. There are
third-party offerings that use the API but none met these requirements:

* Single operation for many photos
* Post each photo with its original date, from its EXIF metadata 
* Post each photo tagged with whatever keywords it has, from its IPTC metadata
* Post each photo with whatever caption it has, from its IPTC metadata
* Deal gracefully with Tumblr upload daily limits

The goal is to support the following workflow:

* Import photos into iPhoto
* Add keywords and descriptions using iPhoto
* Export from iPhoto to local directory
* [ Optional ] Copy up to a friendly remote server with solid connectivity
* Press go, fetch a beer

## Contents

* `bulk-image-uploader.rb` - posts a directory of photos to Tumblr
    * After each photo is uploaded it is moved to a subdirectory called `.done`
    * Each photo post will be dated from the `Date and Time (Original)` EXIF tag (0x9003), if present. If a photo has no such tag the previous photo's date is used.
    * Each photo post will be tagged with the photo's IPTC keywords, if present
    * Each photo post will be caption with the photo's IPTC caption, if present
    * Additional tags for year and year-month are added to the post
    * If an upload fails owing to a transient network failure it will be retried a few times
    * If an upload fails owing to a Tumblr upload limit then the script sleeps for some hours and tries again
* `tumblr_tool.rb` - wrapper around the `tumblr` gem to provide some utility functions
* `config.yml.sample` - diddy config file. copy it to `config.yml` and fill it in

## Extras

* `pull-posts.rb` - fetches all the posts for a Tumblr blog and stores their YAML representation in a snapshot directory
* `push-posts.rb` - compares the snapshot directory generated by `pull-posts` to a working copy and uploads the posts that have changed (eg: tag fixes, updated captions)

## Requirements

* Mark Wunsch's splendid [`tumblr` gem](https://github.com/mwunsch/tumblr)
* A Tumblr API key, secret, token and token secret. The `tumblr` gem [helps you token up](https://github.com/mwunsch/tumblr#authorization)
* Recent Ruby
* Patience with code written on the road, in the heat and at the end of thin internet string
* [`libiptcdata`](http://libiptcdata.sourceforge.net) for `iptc` to read photo keywords and captions
* [`libexif`](http://libexif.sourceforge.net) for `exif` to read photo dates

## Remarks

To post photos from iPhoto, export the photos with the checkboxes ticked to
'Include Title and keywords' to ensure the metadata is written out to the image
file. Exporting with a sequential filename helps keep things understandable,
too. See [screenshot](https://raw.github.com/wiki/zomo/tumblr-tools/iphoto-export.jpg).

It's worth running the bulk uploader under a
[`screen(1)`](http://www.gnu.org/software/screen/) session or similar, because
it can be a long running process if it needs to back off owing to exceeding the
Tumblr post limit (currently 75 per day).

## License

Released under [ASL](http://www.opensource.org/licenses/Apache-2.0). See
LICENSE for details.

## Author and Copyright

Copyright 2013 Jon Stuart (jon@zomo.co.uk), [Zomo Technology Ltd](http://www.zomo.co.uk)
